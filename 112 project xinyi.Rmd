---
title: 'Tidy Tuesday #5'
author: "Xinyi Li"
output: 
  html_document:
    df_print: paged
    code_download: true
    theme: cerulean
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, error=TRUE, message=FALSE, warning=FALSE)
```

```{r}
library(dplyr)
library(tidyverse)
library(readr)
library(plotly)
library(gganimate)
library(lubridate)     
library(ggthemes)      
library(janitor)       
library(ggplot2)
library(cowplot)
library(magick)
library(knitr)
theme_set(theme_minimal()) 
```

```{r}
heart<-read_csv("heart_2020_cleaned.csv")
```


```{r}
summary(heart)

heart %>% 
  group_by(Race) %>% 
  count(HeartDisease)

#bmi groups
bmi_groups <- heart %>% 
  mutate(bmi_group=case_when(BMI<18.5~"Underweight",
                         BMI>=18.5 & BMI<=24.9~"Normal Weight",
                         BMI>=25 & BMI<=29.9~"Overweight",
                         BMI>=30 & BMI<=34.9~"Obesity Class I",
                         BMI>=35 & BMI<=35.9~"Obesity Class II",
                         BMI>=36~"Extreme Obesity"))

#pattern for mutivariables 
heart %>% 
  filter(HeartDisease=="Yes",Sex=="Male") %>% 
  mutate(num=n()) %>% 
  ggplot(aes(x=Smoking,y=num))+
  geom_col()+
  scale_y_continuous(labels=scales::comma)
  
```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

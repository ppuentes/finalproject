---
title: 'Tidy Tuesday #5'
author: "Xinyi Li"
output: 
  html_document:
    df_print: paged
    code_download: true
    theme: cerulean
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, error=TRUE, message=FALSE, warning=FALSE)
```

```{r}
library(dplyr)
library(tidyverse)
library(readr)
library(plotly)
library(gganimate)
library(lubridate)     
library(ggthemes)      
library(janitor)       
library(ggplot2)
library(cowplot)
library(magick)
library(knitr)
theme_set(theme_minimal()) 
```

```{r}
heart<-read_csv("heart_2020_cleaned.csv")
```


```{r}
summary(heart)

heart %>% 
  group_by(Race) %>% 
  count(HeartDisease)

#pattern for mutivariables 
heart %>% 
  filter(HeartDisease=="Yes",Sex=="Male") %>% 
  mutate(num=n()) %>% 
  ggplot(aes(x=Smoking,y=num))+
  geom_col()+
  scale_y_continuous(labels=scales::comma)

```
```{r}
#section 3
#correlation with bmi and heart disease
heart %>% 
  filter(BMI<50) %>% 
  ggplot(aes(x=HeartDisease,y=BMI))+
  geom_boxplot()+
  labs(title="BMI average of groups with and without Heart Disease")+
  theme(plot.title = element_text(hjust=0.5,face="bold"))
```

```{r}
#section4
#bmi groups
bmi_groups <- heart %>% 
  mutate(bmi_group=case_when(BMI<18.5~"Underweight",
                         BMI>=18.5 & BMI<=24.9~"Normal Weight",
                         BMI>=25 & BMI<=29.9~"Overweight",
                         BMI>=30 & BMI<=34.9~"Obesity Class I",
                         BMI>=35 & BMI<=35.9~"Obesity Class II",
                         BMI>=36~"Extreme Obesity"))

#bmi groups and heart disease
bmi_groups %>% 
  filter(is.na(bmi_group)==FALSE) %>% 
  ggplot(aes(x=HeartDisease,y=bmi_group,fill=bmi_group))+
  geom_col()+
  labs(title="BMI groups with and without Heart Disease",
       y="")+
  theme(legend.position="none",
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(),
        plot.title = element_text(hjust=0.5,face="bold"))+
  facet_wrap(vars(bmi_group))

#facet over race
#subject to change
#filter to 50?
bmi_groups %>% 
  filter(BMI<50) %>% 
  filter(is.na(bmi_group)==FALSE) %>% 
  select(HeartDisease,BMI,Race) %>% 
  group_by(Race,HeartDisease) %>% 
  mutate(mean_bmi=mean(BMI)) %>% 
  ggplot(aes(x=HeartDisease,y=mean_bmi,fill=Race))+
  geom_col()+
  theme(legend.position="none",
        plot.title = element_text(hjust=0.5,face="bold"),
        panel.grid.major = element_blank())+
  scale_y_continuous(labels=scales::comma,limits = c(0,50))+
  facet_wrap(vars(Race))+
  labs(title="BMI average of race groups with and without Heart Disease",
       y="Average BMI")


#facet over age group

#over smoking?

#over sex ?
#limits? 55 kai
bmi_groups %>% 
  filter(BMI<50) %>% 
  group_by(Race,HeartDisease,Sex) %>% 
  mutate(mean_bmi=mean(BMI)) %>% 
  ggplot(aes(x=HeartDisease,y=mean_bmi,fill=Sex))+
  geom_bar(stat = "identity")+
  scale_y_continuous(labels=scales::comma)+
  facet_wrap(vars(Race))


#other graph type?
#other correlation type?
#anyway to make scatter or linear?
```

```{r}

```

```{r}

```

```{r}

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

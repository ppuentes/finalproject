---
title: 'Tidy Tuesday #5'
author: "Xinyi Li"
output: 
  html_document:
    df_print: paged
    code_download: true
    theme: cerulean
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, error=TRUE, message=FALSE, warning=FALSE)
```

```{r}
library(dplyr)
library(tidyverse)
library(readr)
library(plotly)
library(gganimate)
library(lubridate)     
library(ggthemes)      
library(janitor)       
library(ggplot2)
library(cowplot)
library(magick)
library(knitr)
theme_set(theme_minimal()) 
```

```{r}
heart<-read_csv("heart_2020_cleaned.csv")
```


```{r}
summary(heart)

heart %>% 
  group_by(Race) %>% 
  count(HeartDisease)

#pattern for mutivariables 
heart %>% 
  filter(HeartDisease=="Yes",Sex=="Male") %>% 
  mutate(num=n()) %>% 
  ggplot(aes(x=Smoking,y=num))+
  geom_col()+
  scale_y_continuous(labels=scales::comma)

```

```{r}
#bmi groups
bmi_groups <- heart %>% 
  mutate(bmi_group=case_when(BMI<18.5~"Underweight",
                         BMI>=18.5 & BMI<=24.9~"Normal Weight",
                         BMI>=25 & BMI<=29.9~"Overweight",
                         BMI>=30 & BMI<=34.9~"Obesity Class I",
                         BMI>=35 & BMI<=35.9~"Obesity Class II",
                         BMI>=36~"Extreme Obesity"))

#correlation with bmi and heart disease
heart %>% 
  filter(BMI<50) %>% 
  ggplot(aes(x=HeartDisease,y=BMI))+
  geom_boxplot()+
  labs(title="BMI average of groups with and without Heart Disease")+
  theme(plot.title = element_text(hjust=0.5,face="bold"))

bmi_groups %>% 
  filter(is.na(bmi_group)==FALSE) %>% 
  ggplot(aes(x=HeartDisease,y=bmi_group,fill=bmi_group))+
  geom_col()+
  facet_wrap(vars(bmi_group))

#facet over race
bmi_groups %>% 
  filter(is.na(bmi_group)==FALSE) %>% 
  select(HeartDisease,BMI,Race) %>% 
  group_by(Race,HeartDisease) %>% 
  mutate(mean_bmi=mean(BMI)) %>% 
  ggplot(aes(x=HeartDisease,y=mean_bmi,fill=Race))+
  geom_col()+
  geom_text(aes(label=mean_bmi), vjust=1.6, size=3.5)+
  scale_y_continuous(labels=scales::comma,limits = c(0,100))+
  facet_wrap(vars(Race))

#facet over age group
```

```{r}

```

```{r}

```

```{r}

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

---
title: "project_final"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(readr)
library(dplyr)
library(tidyverse)
library(ggplot2)
library(janitor)
library(plotly)
library(gganimate)
library(ggthemes)
```


Reading in:

```{r}
health <- read_csv("heart_2020_cleaned.csv")
```

```{r}
bmi_groups <- health %>% 
  clean_names() %>% 
  mutate(bmi_group=case_when(bmi<18.5~"Underweight",
                         bmi>=18.5 & bmi<=24.9~"Normal Weight",
                         bmi>=25 & bmi<=29.9~"Overweight",
                         bmi>=30 & bmi<=34.9~"Obesity Class I",
                         bmi>=35 & bmi<=35.9~"Obesity Class II",
                         bmi>=36~"Extreme Obesity"))

```

```{r}
weight <- 73
height <- 171

dataset <- tibble(weight,
                  height) %>% 
  mutate(BMI_val = weight/((height/100)^2),
         bmi_cat = case_when(BMI_val<18.5~"Underweight",
                         BMI_val>=18.5 & BMI_val<25~"Normal Weight",
                         BMI_val>=25 & BMI_val<30~"Overweight",
                         BMI_val>=30 & BMI_val<35~"Obesity Class I",
                         BMI_val>=35 & BMI_val<36~"Obesity Class II",
                         BMI_val>=36~"Extreme Obesity")) 
user_bmi <- dataset$bmi_cat

dataset

bmi_groups %>% 
  clean_names() %>% 
  filter(bmi_group == user_bmi,
         sex == "Female",
         age_category == "18-24",
         physical_activity == "No") %>% 
  summarize(heart_disease_prevalence =  (sum(heart_disease == "Yes")/n())*100,
            no_heart_disease = (sum(heart_disease == "No")/n())*100)
```

```{r}
table(bmi_groups$gen_health)
```

